<!-- Tab Content(vulnerability) -->
<div class="tab-content">
  <!-- Graph -->
  <div class="section-graph">
    <div class="graph-area">
      <!-- 그래프 영역 -->
      <div class="graph-block" id="chartVulnerabilities" style="width: 176px; height: 176px;"></div>
      <!-- //그래프 영역 -->
    </div>

    <div class="description-area">
      <span class="txt-title" *ngIf="vulnerabilityCount == 0">
        TACO Security Scanner has detected no vulnerabilities in this image.
      </span>
      <span class="txt-title" *ngIf="vulnerabilityCount">
        TACO Security Scanner has detected <strong>{{ vulnerabilityCount }}</strong> vulnerabilities.
      </span>
      <p class="txt-desc" *ngIf="patchAvailableCount">
        Patches are available for <strong>{{ patchAvailableCount }}</strong> vulnerabilities.
      </p>
      <ul class="list-legend">
        <li *ngIf="highCount">
          <em style="background-color:#f8523f;"></em>
          <span class="txt-legend">
            <strong>{{ highCount }}</strong>
            High-level vulnerabilities.
          </span>
        </li>
        <li *ngIf="mediumCount">
          <em style="background-color:#fd7e14;"></em>
          <span class="txt-legend">
            <strong>{{ mediumCount }}</strong>
            Medium-level vulnerabilities.
          </span>
        </li>
        <li *ngIf="lowCount">
          <em style="background-color:#fcc419;"></em>
          <span class="txt-legend">
            <strong>{{ lowCount }}</strong>
            Low-level vulnerabilities.
          </span>
        </li>
        <li *ngIf="negiCount">
          <em style="background-color:#b7b9c2;"></em>
          <span class="txt-legend">
            <strong>{{ negiCount }}</strong>
            Negligible-level vulnerabilities.
          </span>
        </li>
        <li *ngIf="unknownCount">
          <em style="background-color:#b7b9c2;"></em>
          <span class="txt-legend">
            <strong>{{ unknownCount }}</strong>
            Unknown-level vulnerabilities.
          </span>
        </li>
      </ul>
    </div>
  </div>
  <!-- //Graph -->

  <!-- Filter -->
  <div class="section-filter" [hidden]="!(vulnerabilityList | filter:{Name: searchKey, packageName: searchKey}).length">
    <div class="filter-area">
      <div class="component-checkbox">
        <input type="checkbox" class="input-checkbox" id="checkbox1" (change)="changeCheck()" [(ngModel)]="onlyFixed">
        <label class="txt-label" for="checkbox1">Show Fixable</label>
      </div>
      <div class="component-search type-filter">
        <input type="text" class="input-search" placeholder="Filter Vulnerabilities" #searchInput (keyup.enter)="searchKey = searchInput.value">
        <span class="icon-search"></span>
        <a href="javascript:;" class="btn-clear" aria-label="Clear" (click)="searchInput.value = ''; searchKey = ''"></a>
      </div>
    </div>
  </div>
  <!-- //Filter -->

  <!-- List -->
  <div class="component-table" *ngIf="(vulnerabilityList | filter:{Name: searchKey, packageName: searchKey}).length">
    <table class="table-security">
      <colgroup>
        <col width="*" />
        <col width="130" />
        <col width="160" />
        <col width="160" />
        <col width="160" />
        <col width="240" />
      </colgroup>
      <thead>
      <tr>
        <th>
          <a href="javascript:;" class="btn-sort" [class.type-asc]="sortProperty == 'Name' && sortDirection == 'asc'" [class.type-desc]="sortProperty == 'Name' && sortDirection == 'desc'" (click)="sortClick('Name')">CVE</a>
        </th>
        <th>
          <a href="javascript:;" class="btn-sort" [class.type-asc]="sortProperty == 'score' && sortDirection == 'asc'" [class.type-desc]="sortProperty == 'score' && sortDirection == 'desc'" (click)="sortClick('score')">Severity</a>
        </th>
        <th>
          <a href="javascript:;" class="btn-sort" [class.type-asc]="sortProperty == 'packageName' && sortDirection == 'asc'" [class.type-desc]="sortProperty == 'packageName' && sortDirection == 'desc'" (click)="sortClick('packageName')">Package</a>
        </th>
        <th>
          <a>Current Version</a>
        </th>
        <th>
          <a>Fixed in version</a>
        </th>
        <th>
          <a>Introduced in layer</a>
        </th>
      </tr>
      </thead>
      <tbody *ngFor="let item of vulnerabilityList | sort:sortProperty:sortDirection | filter:{Name: searchKey, packageName: searchKey};">
        <tr [attr.aria-expanded]="item.expand">
          <td>
            <div class="link-area">
              <a href="javascript:;" class="link-blank" (click)="linkClick(item)"></a>
              <a href="javascript:;" class="link-table" (click)="item.expand = !item.expand">{{ item.Name }}</a>
            </div>
          </td>
          <td>
            <div class="severity-area">
              <span class="txt-status">
                <em [ngStyle]="{'background-color': colorCodes[item.score]}"></em>
                <span [ngStyle]="{'color': colorCodes[item.score]}">{{ item.Severity }}</span>
              </span>
            </div>
          </td>
          <td>
            <span class="txt-package" [title]="item.packageName">{{ item.packageName }}</span>
          </td>
          <td>
            <span class="txt-ver" [title]="item.currentVersion">{{ item.currentVersion }}</span>
          </td>
          <td>
            <span [ngClass]="{'txt-none': !item.FixedBy, 'txt-fixed': item.FixedBy}" [title]="item.FixedBy ? item.FixedBy : ''">{{ item.FixedBy ? item.FixedBy : '(None)' }}</span>
          </td>
          <td>
            <div class="introduce-area">
              <span [ngClass]="'txt-type ' + buildHistoryService.getClassCommandLog(item.layer.commandName)">{{ item.layer.commandName }}</span>
              <span class="txt-desc" [title]="item.layer.commandText">{{ item.layer.commandText }}</span>
            </div>
          </td>
        </tr>
        <tr>
          <td colspan="6">
            <dl class="description-area">
              <dt>Description</dt>
              <dd>
                {{ item.Description }}
              </dd>
            </dl>
          </td>
        </tr>
      </tbody>
    </table>
  </div>
  <!-- //List -->

  <!-- No Data (Search) -->
  <div class="component-nodata" *ngIf="(searchKey && searchKey != '') && !(vulnerabilityList | filter:{Name: searchKey, packageName: searchKey}).length">
    <span class="txt-nodata">No matching vulnerabilities found.</span>
    <p class="txt-desc">There are not matching vulnerabilities for the search.</p>
    <a href="javascript:;" class="link-back" (click)="searchInput.value = ''; clearSearchClick()">Clear Search</a>
  </div>
  <!-- //No Data (Search) -->
</div>
<!-- //Tab Content(vulnerability) -->
